<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>彼岸花とゴミ虫</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: linear-gradient(270deg, #ffd6e0, #ffe0f7, #d6f0ff, #e0ffe8, #fff0d6);
    background-size: 1200% 1200%;
    animation: gradientShift 30s ease infinite;
  }
  @keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }
  canvas {
    display: block;
  }
  .face {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 80px;
    font-weight: bold;
    color: rgba(255, 255, 255, 0.9);
    text-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.3s ease;
  }
</style>
</head>
<body>
<canvas id="sky"></canvas>
<div class="face" id="face1">（^ ω^）</div>
<div class="face" id="face2">(　ﾟ　Д　ﾟ 　)</div>

<script>
const canvas = document.getElementById("sky");
const ctx = canvas.getContext("2d");
let w, h;

function resize() {
  w = canvas.width = window.innerWidth;
  h = canvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

// ゴミ虫（虹色トーン）
const rainbowColors = [
  "#c7d0ff", "#f7c7ff", "#ffd6e0", "#fff0d6", "#e0ffe8", "#d6f0ff"
];
const bugs = Array.from({ length: 1000 }, () => ({
  x: Math.random() * w,
  y: Math.random() * h,
  r: Math.random() * 2 + 1.5,
  speed: Math.random() * 0.6 + 0.2,
  color: rainbowColors[Math.floor(Math.random() * rainbowColors.length)],
  phase: Math.random() * Math.PI * 2
}));

// 彼岸花
function drawSpiderLily() {
  const cx = w / 2, cy = h - 80;
  ctx.save();
  ctx.translate(cx, cy);
  ctx.strokeStyle = "#3a1818";
  ctx.lineWidth = 4;
  ctx.beginPath();
  ctx.moveTo(0, 0);
  ctx.lineTo(0, -120);
  ctx.stroke();

  for (let i = 0; i < 40; i++) {
    const angle = (i / 40) * Math.PI * 2;
    const x = Math.cos(angle) * 50;
    const y = -120 + Math.sin(angle) * 50;
    ctx.beginPath();
    ctx.moveTo(0, -120);
    ctx.lineTo(x, y);
    ctx.strokeStyle = "rgba(255,0,0,0.75)";
    ctx.lineWidth = 2;
    ctx.shadowBlur = 12;
    ctx.shadowColor = "rgba(255,60,60,0.9)";
    ctx.stroke();
  }
  ctx.restore();
  ctx.shadowBlur = 0;
}

// 顔文字の出現
function showFace(faceId) {
  const el = document.getElementById(faceId);
  el.style.opacity = 1;
  setTimeout(() => (el.style.opacity = 0), 800);
}

// クリック判定
canvas.addEventListener("click", e => {
  const mx = e.clientX, my = e.clientY;
  bugs.forEach((s, i) => {
    const dx = s.x - mx, dy = s.y - my;
    if (dx * dx + dy * dy < 50 && i % 100 === 0) {
      showFace(Math.random() < 0.5 ? "face1" : "face2");
    }
  });
});

function animate() {
  ctx.clearRect(0, 0, w, h);
  drawSpiderLily();
  bugs.forEach(s => {
    s.y += s.speed;
    s.x += Math.sin(s.y / 20 + s.phase) * 0.4;
    if (s.y > h) s.y = -10;
    ctx.fillStyle = s.color;
    ctx.shadowBlur = 6;
    ctx.shadowColor = s.color;
    ctx.beginPath();
    ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
    ctx.fill();
  });
  ctx.shadowBlur = 0;
  requestAnimationFrame(animate);
}

animate();
</script>
</body>
</html>
